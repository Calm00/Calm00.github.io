<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Honahec</title>
  
  <subtitle>Honahec</subtitle>
  <link href="http://www.honahec.com/atom.xml" rel="self"/>
  
  <link href="http://www.honahec.com/"/>
  <updated>2021-09-19T11:56:36.967Z</updated>
  <id>http://www.honahec.com/</id>
  
  <author>
    <name>Honahec</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>csp2021</title>
    <link href="http://www.honahec.com/csp2021/"/>
    <id>http://www.honahec.com/csp2021/</id>
    <published>2021-09-19T11:23:26.000Z</published>
    <updated>2021-09-19T11:56:36.967Z</updated>
    
    <content type="html"><![CDATA[<h3 id="day-3"><a href="#day-3" class="headerlink" title="day -3"></a>day -3</h3><p>å¿«åˆèµ›äº†</p><p>åˆ·å®Œè¿™ä¸ªNOIP2016å°±éƒ½åˆ·å®Œäº†</p><p>83.5è¿˜è¡Œ</p><p>ï¼ˆæ„Ÿè§‰å……æ»¡äº†ä¿¡å¿ƒï¼‰</p><h3 id="day-1"><a href="#day-1" class="headerlink" title="day -1"></a>day -1</h3><p>æ˜å¤©å°±è¦åˆèµ›äº†</p><p>å¤§åŠå¤œçš„æˆ‘ä»åœ¨å¿«ä¹åœ°åˆ·è§†é¢‘qwq</p><h3 id="day-0"><a href="#day-0" class="headerlink" title="day 0"></a>day 0</h3><p>ï¼ˆæ—©ä¸Šçš„æˆ‘æ­¤åˆ»è¿˜æ²¡æœ‰æ„è¯†åˆ°äº‹æƒ…çš„ä¸¥é‡æ€§ï¼‰</p><p>è¿™é¢˜æ€ä¹ˆä¸€å¹´æ¯”ä¸€å¹´é˜´é—´</p><p>ä»€ä¹ˆbase64ç¼–ç ï¼Œç¬›å¡å°”æ ‘+Euleråºåˆ—æRMQ</p><p>æœ€åä¸€é¢˜è¿˜121è¡Œ</p><p>å®Œå…¨ä¸ä¼šå‘œå‘œå‘œ</p><p>åˆåˆ†56.5ï¼Œåæ ‡SDï¼Œå¾ˆæ…Œ</p><p><strong>å¦‚æœèƒ½è¿‡ä¼šç»§ç»­åœ¨è¿™ç¯‡åšå®¢æ›´æ–°å¤èµ›</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;day-3&quot;&gt;&lt;a href=&quot;#day-3&quot; class=&quot;headerlink&quot; title=&quot;day -3&quot;&gt;&lt;/a&gt;day -3&lt;/h3&gt;&lt;p&gt;å¿«åˆèµ›äº†&lt;/p&gt;
&lt;p&gt;åˆ·å®Œè¿™ä¸ªNOIP2016å°±éƒ½åˆ·å®Œäº†&lt;/p&gt;
&lt;p&gt;83.5è¿˜è¡Œ&lt;/p&gt;
&lt;p&gt;ï¼ˆæ„Ÿè§‰å……æ»¡</summary>
      
    
    
    
    <category term="æ¯”èµ›" scheme="http://www.honahec.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="æ¸¸è®°" scheme="http://www.honahec.com/tags/%E6%B8%B8%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ACSLæ¸¸è®°</title>
    <link href="http://www.honahec.com/acsl-you-ji/"/>
    <id>http://www.honahec.com/acsl-you-ji/</id>
    <published>2021-09-14T11:24:25.000Z</published>
    <updated>2021-09-17T12:45:11.477Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ä¸ä¹…<del>(å…¶å®ä¹Ÿæ²¡æœ‰ä¸ä¹…å•¦</del>æœ¬è’Ÿè’»å»å‚åŠ äº†ACSL</p><h3 id="Day-5"><a href="#Day-5" class="headerlink" title="Day -5"></a>Day -5</h3><p>å› ä¸ºæ²¡æœ‰é˜Ÿå‹ï¼ŒASDANç»™æˆ‘éšæœºåŒ¹é…åˆ°äº†ä¸€ä½<a href="https://github.com/Nambers">å¤§ä½¬</a>qwq</p><p>ç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯è‡ªåˆ¶æ¸¸æˆå¹¶å½•åˆ¶vlogï¼ï¼Ÿï¼Ÿæˆ‘ç›´æ¥äººå‚»äº†ï¼Œå¹¸å¥½å¤§ä½¬æ›¾ç»è‡ªå·±åšè¿‡ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°±å¾ˆéšæ„åœ°ç›´æ¥ä½¿ç”¨äº†é‚£ä¸ªæ¸¸æˆï¼Œç„¶åå¾ˆéšæ„åœ°åˆ¶ä½œäº†ä¸€ä¸ªvlog</p><p>ä¸»è¦æ˜¯5å¤©ä¹Ÿåšä¸äº†æ¸¸æˆå•Šï¼ˆå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†</p><p><a href="https://github.com/Nambers/abattoir">æ¸¸æˆæºç </a></p><p>vlogï¼š</p><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">    <iframe src="//player.bilibili.com/player.html?aid=932985969&bvid=BV14M4y1g7C5&cid=408218084&page=1"  scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"></iframe></div><h3 id="Day-0"><a href="#Day-0" class="headerlink" title="Day 0"></a>Day 0</h3><p><del>è¿™æ¯”èµ›ä¸ºä»€ä¹ˆè¦æ‰“ä¸€å¤©ï¼ï¼Ÿï¼Ÿ</del></p><h4 id="ä¸Šåˆ"><a href="#ä¸Šåˆ" class="headerlink" title="ä¸Šåˆ"></a>ä¸Šåˆ</h4><p>é€‰æ‹©é¢˜ç›´æ¥è¢«lispæ‰“è’™äº†ï¼ˆæ˜æ˜å¤ä¹ è¿‡äº†ï¼Œä½†æœ‰äº›æ ¹æœ¬ç™¾åº¦ä¸åˆ°å‘œå‘œå‘œ</p><p>å–œæ15/20</p><h4 id="ä¸‹åˆ"><a href="#ä¸‹åˆ" class="headerlink" title="ä¸‹åˆ"></a>ä¸‹åˆ</h4><p>å¤§æ¦‚çœ‹äº†ä¸€çœ¼é¢˜ç›®ï¼šå°±è¿™ï¼Ÿï¼Ÿ</p><p>ä¸å¾—ä¸è¯´ï¼Œæ˜¯çœŸçš„æ°´</p><p>t2æˆ‘ç›´æ¥20åˆ†é’Ÿåˆ‡æ‰</p><p>ä¸ºä»€ä¹ˆå…ˆè¯´t2å‘¢</p><p>å› ä¸ºt1æœ‰4ä¸ªç‚¹å°±æ˜¯è°ƒä¸å¯¹ï¼Œè¿™å°±æ˜¯ä¸ä¼šæ‰“å¯¹æ‹çš„ç—›è‹¦å—qwq</p><p>å–œæ16/20</p><h3 id="Day-1"><a href="#Day-1" class="headerlink" title="Day 1"></a>Day 1</h3><p>æ„Ÿè§‰è‡ªå·±ä¸€åˆ°æœ€åå°±æ€»æ˜¯å‡ºä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œå”‰</p><p>cspå†²å†²å†²ï¼ï¼ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‰ä¸ä¹…&lt;del&gt;(å…¶å®ä¹Ÿæ²¡æœ‰ä¸ä¹…å•¦&lt;/del&gt;æœ¬è’Ÿè’»å»å‚åŠ äº†ACSL&lt;/p&gt;
&lt;h3 id=&quot;Day-5&quot;&gt;&lt;a href=&quot;#Day-5&quot; class=&quot;headerlink&quot; title=&quot;Day -5&quot;&gt;&lt;/a&gt;Day -5&lt;/h3&gt;&lt;p&gt;å› ä¸ºæ²¡æœ‰é˜Ÿå‹ï¼ŒASDANç»™æˆ‘</summary>
      
    
    
    
    <category term="éšä¾¿è¯´è¯´" scheme="http://www.honahec.com/categories/%E9%9A%8F%E4%BE%BF%E8%AF%B4%E8%AF%B4/"/>
    
    
    <category term="æ¸¸è®°" scheme="http://www.honahec.com/tags/%E6%B8%B8%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>åšå®¢ç»´æŠ¤åŠ¨æ€</title>
    <link href="http://www.honahec.com/update/"/>
    <id>http://www.honahec.com/update/</id>
    <published>2021-09-05T08:43:27.000Z</published>
    <updated>2021-09-19T07:10:04.300Z</updated>
    
    <content type="html"><![CDATA[<h3 id="update-2021-9-5"><a href="#update-2021-9-5" class="headerlink" title="update 2021.9.5"></a>update 2021.9.5</h3><p>æ•°å­¦å…¬å¼å·²ç»ç»´æŠ¤å®Œæ¯•ï¼ï¼ï¼ï¼ˆèµ·ç ç›®å‰çœ‹æ¥æ˜¯è¿™æ ·çš„</p><h3 id="update-2021-9-12"><a href="#update-2021-9-12" class="headerlink" title="update 2021.9.12"></a>update 2021.9.12</h3><p>ä»Šå¤©çæäº†ä¸€ä¸‹ï¼Œä¼˜åŒ–äº†ä½“éªŒï¼ˆä½†ä¸ºä»€ä¹ˆä¸èƒ½é¡µå†…è·³è½¬äº†qwqï¼Œæˆ‘è¿˜æ²¡å¤‡ä»½â€¦çææœ‰é£é™©ï¼Œè®°å¾—å¤‡ä»½å‘œå‘œå‘œ</p><h3 id="update-2021-9-19"><a href="#update-2021-9-19" class="headerlink" title="update 2021.9.19"></a>update 2021.9.19</h3><p><strong>æ›´æ¢ä¸»é¢˜ä¸ºVolantis</strong></p><p>æ·»åŠ å‹é“¾é¡µé¢ï¼ˆæ¬¢è¿äº’æ¢ï¼‰</p><p>æ·»åŠ abouté¡µé¢</p><p>æ·»åŠ å¼€å¾€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;update-2021-9-5&quot;&gt;&lt;a href=&quot;#update-2021-9-5&quot; class=&quot;headerlink&quot; title=&quot;update 2021.9.5&quot;&gt;&lt;/a&gt;update 2021.9.5&lt;/h3&gt;&lt;p&gt;æ•°å­¦å…¬å¼å·²ç»ç»´æŠ¤å®Œæ¯•ï¼ï¼ï¼ï¼ˆèµ·ç ç›®å‰</summary>
      
    
    
    
    <category term="éšä¾¿è¯´è¯´" scheme="http://www.honahec.com/categories/%E9%9A%8F%E4%BE%BF%E8%AF%B4%E8%AF%B4/"/>
    
    
    <category term="æ‘¸é±¼" scheme="http://www.honahec.com/tags/%E6%91%B8%E9%B1%BC/"/>
    
  </entry>
  
  <entry>
    <title>æ–œç‡ä¼˜åŒ–dp</title>
    <link href="http://www.honahec.com/xie-lv-you-hua-dp/"/>
    <id>http://www.honahec.com/xie-lv-you-hua-dp/</id>
    <published>2021-06-25T13:53:49.000Z</published>
    <updated>2021-09-17T12:45:11.490Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ–œç‡ä¼˜åŒ–-dp"><a href="#æ–œç‡ä¼˜åŒ–-dp" class="headerlink" title="æ–œç‡ä¼˜åŒ– $ dp $"></a>æ–œç‡ä¼˜åŒ– $ dp $</h1><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><div class="table-container"><table><thead><tr><th>åç§°</th><th>å®šä¹‰</th></tr></thead><tbody><tr><td>å‡¸å¤šè¾¹å½¢</td><td>æ‰€æœ‰å†…è§’éƒ½åœ¨ $ (0Â°,180Â°) $ çš„ç®€å•å¤šè¾¹å½¢</td></tr><tr><td>å‡¸åŒ…</td><td>åœ¨å¹³é¢ä¸Šèƒ½åŒ…å«æ‰€æœ‰ç»™å®šç‚¹çš„æœ€å°å‡¸å¤šè¾¹å½¢å«åšå‡¸åŒ…ã€‚</td></tr><tr><td>ä¸Šå‡¸åŒ…</td><td>å‡¸åŒ…ä¸­æ¨ªåæ ‡æœ€å°çš„ç‚¹åˆ°æ¨ªåæ ‡æœ€å¤§çš„ç‚¹çš„ä¸ŠåŠéƒ¨åˆ†</td></tr><tr><td>ä¸‹å‡¸åŒ…</td><td>å‡¸åŒ…ä¸­æ¨ªåæ ‡æœ€å°çš„ç‚¹åˆ°æ¨ªåæ ‡æœ€å¤§çš„ç‚¹çš„ä¸‹åŠéƒ¨åˆ†</td></tr></tbody></table></div><center>å¦‚ä¸‹å›¾ï¼Œè“è‰²éƒ¨åˆ†æ˜¯ä¸Šå‡¸åŒ…ï¼Œæ©™è‰²éƒ¨åˆ†æ˜¯ä¸‹å‡¸åŒ…</center><p><img src="https://cdn.jsdelivr.net/gh/Calm00/PicGo/img/dp1.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/Calm00/PicGo/img/dp1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" style="zoom:25%;" /></p><blockquote><p>è®©æˆ‘ä»¬é€šè¿‡ä¾‹é¢˜æ¥å­¦ä¹ æ–œç‡ä¼˜åŒ– $ dp $ </p></blockquote><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="HNOI2008-ç©å…·è£…ç®±"><a href="#HNOI2008-ç©å…·è£…ç®±" class="headerlink" title="[HNOI2008] ç©å…·è£…ç®±"></a><a href="https://www.luogu.com.cn/problem/P3195">[HNOI2008] ç©å…·è£…ç®±</a></h3><h4 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h4><p>P æ•™æˆè¦å»çœ‹å¥¥è¿ï¼Œä½†æ˜¯ä»–èˆä¸ä¸‹ä»–çš„ç©å…·ï¼Œäºæ˜¯ä»–å†³å®šæŠŠæ‰€æœ‰çš„ç©å…·è¿åˆ°åŒ—äº¬ã€‚ä»–ä½¿ç”¨è‡ªå·±çš„å‹ç¼©å™¨è¿›è¡Œå‹ç¼©ï¼Œå…¶å¯ä»¥å°†ä»»æ„ç‰©å“å˜æˆä¸€å †ï¼Œå†æ”¾åˆ°ä¸€ç§ç‰¹æ®Šçš„ä¸€ç»´å®¹å™¨ä¸­ã€‚</p><p>P æ•™æˆæœ‰ç¼–å·ä¸º  $ 1 \cdots n $  çš„  $ n $  ä»¶ç©å…·ï¼Œç¬¬ä»¶ç©å…·ç»è¿‡å‹ç¼©åçš„ä¸€ç»´é•¿åº¦ä¸º  $ C_i $ ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿æ•´ç†ï¼ŒPæ•™æˆè¦æ±‚ï¼š</p><ul><li>åœ¨ä¸€ä¸ªä¸€ç»´å®¹å™¨ä¸­çš„ç©å…·ç¼–å·æ˜¯è¿ç»­çš„ã€‚</li><li>åŒæ—¶å¦‚æœä¸€ä¸ªä¸€ç»´å®¹å™¨ä¸­æœ‰å¤šä¸ªç©å…·ï¼Œé‚£ä¹ˆä¸¤ä»¶ç©å…·ä¹‹é—´è¦åŠ å…¥ä¸€ä¸ªå•ä½é•¿åº¦çš„å¡«å……ç‰©ã€‚å½¢å¼åœ°è¯´ï¼Œå¦‚æœå°†ç¬¬  $ i $  ä»¶ç©å…·åˆ°ç¬¬  $ j $  ä¸ªç©å…·æ”¾åˆ°ä¸€ä¸ªå®¹å™¨ä¸­ï¼Œé‚£ä¹ˆå®¹å™¨çš„é•¿åº¦å°†ä¸º  $ x=j-i+\sum_{k=i}^{j}C_k $ ã€‚</li></ul><p>åˆ¶ä½œå®¹å™¨çš„è´¹ç”¨ä¸å®¹å™¨çš„é•¿åº¦æœ‰å…³ï¼Œæ ¹æ®æ•™æˆç ”ç©¶ï¼Œå¦‚æœå®¹å™¨é•¿åº¦ä¸º  $ x $ ï¼Œå…¶åˆ¶ä½œè´¹ç”¨ä¸º  $ (x-L)^2 $ ã€‚å…¶ä¸­  $ L $  æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚P æ•™æˆä¸å…³å¿ƒå®¹å™¨çš„æ•°ç›®ï¼Œä»–å¯ä»¥åˆ¶ä½œå‡ºä»»æ„é•¿åº¦çš„å®¹å™¨ï¼Œç”šè‡³è¶…è¿‡  $ L $ ã€‚ä½†ä»–å¸Œæœ›æ‰€æœ‰å®¹å™¨çš„æ€»è´¹ç”¨æœ€å°ã€‚</p><h4 id="è¾“å…¥æ ¼å¼"><a href="#è¾“å…¥æ ¼å¼" class="headerlink" title="è¾“å…¥æ ¼å¼"></a>è¾“å…¥æ ¼å¼</h4><p>ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ•´æ•°ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«ä»£è¡¨  $ n $  å’Œ  $ L $ ã€‚</p><p>ç¬¬  $ 2 $  åˆ° ç¬¬  $ (n+1) $  è¡Œï¼Œæ¯è¡Œä¸€ä¸ªæ•´æ•°ï¼Œç¬¬  $ (i+1) $  è¡Œçš„æ•´æ•°ä»£è¡¨ç¬¬  $ i $  ä»¶ç©å…·çš„é•¿åº¦  $ C_i $ ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h4><p>è¾“å‡ºä¸€è¡Œä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ‰€æœ‰å®¹å™¨çš„æ€»è´¹ç”¨æœ€å°æ˜¯å¤šå°‘ã€‚</p><h4 id="æ•°æ®èŒƒå›´"><a href="#æ•°æ®èŒƒå›´" class="headerlink" title="æ•°æ®èŒƒå›´"></a>æ•°æ®èŒƒå›´</h4><p>å¯¹äºå…¨éƒ¨çš„æµ‹è¯•ç‚¹ï¼Œ $ 1 \leq n \leq 5 \times 10^4,1 \leq L \leq 10^7,1 \leq C_i \leq 10^7 $ </p><h3 id="åŸºæœ¬-dp-æ€è·¯"><a href="#åŸºæœ¬-dp-æ€è·¯" class="headerlink" title="åŸºæœ¬ $ dp $ æ€è·¯"></a>åŸºæœ¬ $ dp $ æ€è·¯</h3><p>è®¾ $ F_i $ ä¸ºè£…å‰ $ i $ ä¸ªç©å…·çš„æœ€å°è´¹ç”¨ï¼Œåˆ™ $ F_i=min_{0\leq j&lt;i}(F_j+(i-j-1-L+\sum^{i}_{k=j+1}C_k)^2) $ </p><p>å…¶ä¸­ $ \sum^{i}_{k = j+1} C_k $ å¯ä»¥ç”¨å‰ç¼€å’Œä¼˜åŒ–æ‰ï¼Œå˜æˆ $ F_i = min_{0 \leq j&lt;i}(F_j+(i-j-1-L+sum_i-sum_j)^2) $ </p><p>éå¸¸å¥½å•Šï¼Œ $ O(n^2) $ ï¼Œ0åˆ†åˆ°æ‰‹</p><p>æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><h3 id="å¤„ç†ä¸€ä¸‹"><a href="#å¤„ç†ä¸€ä¸‹" class="headerlink" title="å¤„ç†ä¸€ä¸‹"></a>å¤„ç†ä¸€ä¸‹</h3><p>è¿™ä¸ª $ dp $ æ–¹ç¨‹å¥½åƒä¸å¤ªå¥½å¤„ç†</p><p>é¦–å…ˆæˆ‘ä»¬ä¸çœ‹è¿™ä¸ª $ min $ ï¼Œåªçœ‹ $ F_i=F_j+(i-j-1-L+sum_i-sum_j )^2 $ </p><script type="math/tex; mode=display">\begin{align}ä»¤A=i+sum_iï¼ŒB&=j+sum_jï¼ŒC=L+1\\F_j+(A-B-C)^2&=F_j+A^2+(B+C)^2-2A(B+C)\\F_i+2A(B+C)&=F_j+A^2+(B+C)^2\\ä»¤x=B+Cï¼Œy=F_j&+(B+C)^2ï¼Œk=2Aï¼Œb=F_i-A^2\\y&=kx+b\end{align}</script><p>æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿ</p><p>æˆ‘ä»¬è¦æœ€å°åŒ– $ F_i $ ï¼Œé‚£ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æœ€å°åŒ– $ b $ </p><p>å¯¹äºæ¯ä¸€ä¸ªç¡®å®šçš„ $ i $ ï¼Œ $ k $ éƒ½æ˜¯ç¡®å®šçš„</p><p>é—®é¢˜è½¬åŒ–æˆäº†æ±‚è¿‡ $ (B+C, F_j+(B+C)^2) $ ä¸­ä»»æ„ä¸€ç‚¹ä¸”æ–œç‡ä¸ºkçš„ç›´çº¿æˆªè·çš„æœ€å°å€¼ã€‚</p><h4 id="è¡¥å……çŸ¥è¯†"><a href="#è¡¥å……çŸ¥è¯†" class="headerlink" title="è¡¥å……çŸ¥è¯†"></a>è¡¥å……çŸ¥è¯†</h4><p><strong>å¦‚æœä½ åªæƒ³çŸ¥é“æ–œç‡ä¼˜åŒ–æ€ä¹ˆç”¨ï¼Œé‚£ä¹ˆä½ å¯ä»¥<a href="#toc-heading-11">ç‚¹æ­¤</a>è·³è¿‡è¿™éƒ¨åˆ†ã€‚</strong></p><p>æˆ‘ä»¬æ˜“å¯è¯æˆªè·çš„æœ€å°å€¼ä¸€å®šå–åœ¨ä¸‹å‡¸åŒ…ä¸Š</p><p>è¯æ˜ï¼šå‡å¦‚æˆªè·çš„æœ€å°å€¼å–åœ¨éä¸‹å‡¸åŒ…ä¸Šçš„ä¸€ä¸ªç‚¹ $ (x_0,y_0 ) $ ï¼Œåˆ™æœ‰ä¸¤ç§æƒ…å†µï¼š</p><p>ï¼ˆä¸€ï¼‰ ä¸‹å‡¸åŒ…ä¸Šæœ‰ä¸€ä¸ªç‚¹ $ (x_0,y_1) $ </p><p>æ‰€ä»¥è¿‡ $ (x_0,y_0) $ çš„ç›´çº¿çš„è§£æå¼ä¸º $ y=kx+y_0-kx_0 $ ï¼Œè¿‡ $ (x_0,y_1) $ çš„ç›´çº¿çš„è§£æå¼ä¸º $ y=kx+y_1-kx_0 $ </p><p>æ ¹æ®ä¸‹å‡¸åŒ…çš„å®šä¹‰å¯å¾— $ y_0&gt;y_1 $ ï¼Œæ•… $ y_0-kx_0&gt;y_1-kx_1 $ ï¼ŒçŸ›ç›¾</p><p>ï¼ˆäºŒï¼‰ ä¸‹å‡¸åŒ…ä¸Šæ²¡æœ‰å’Œå…¶æ¨ªåæ ‡ç›¸åŒçš„ç‚¹</p><p>æ ¹æ®ä¸‹å‡¸åŒ…çš„å®šä¹‰ï¼Œå¯å¾—ä¸‹å‡¸åŒ…ä¸Šä¸€å®šå­˜åœ¨ä¸¤ä¸ªç‚¹ $ (x_1,y_1) $ , $ (x_2,y_2) $ ä½¿å¾— $ x_1&lt;x_0&lt;x_2 $ ä¸” $ x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-x_2}&lt;y_0 $ </p><p>æˆ‘ä»¬åœ¨ç»è¿‡ $ (x_1,y_1) $ ,  $ (x_2,y_2) $ çš„ç›´çº¿ä¸Šå–ä¸€ç‚¹ $ (x_0,x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-xx_2}) $ </p><ul><li>è¿‡ $ (x_0,y_0) $ çš„ç›´çº¿è§£æå¼ä¸º $ y=kx+y_0-kx_0 $ </li><li>è¿‡ $ (x_0,x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-x_2}) $ çš„ä¸º $ y=kx+x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-x_2}-kx_0 $ </li><li>è¿‡ $ (x_1,y_1) $ çš„ä¸º $ y=kx+y_1-kx_1 $ </li><li>è¿‡ $ (x_2,y_2) $ çš„ä¸º $ y=kx+y_2-kx_2 $ </li></ul><p>ç”±ï¼ˆä¸€ï¼‰å¯å¾— $ y_0-kx_0&gt;x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-x_2}-kx_0 $ </p><script type="math/tex; mode=display">\begin{align}&k>\frac{y_1-y_2}{x_1-x_2}\\&(x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-x_2 }-kx_0)-(y_1-kx_1 )\\&=\frac{x_0 y_1-x_0 y_2+x_1 y_2-x_1 y_1}{x_1-x_2}-k(x_1-x_0)\\&=\frac{(x_0-x_1)(y_1-y_2)}{x_1-x_2}-k(x_0-x_1)\\&>\frac{(x_0-x_1 )(y_1-y_2)}{x_1-x_2}-\frac{(x_0-x_1)(y_1-y_2 )}{x_1-x_2}\\&=0\end{align}</script><script type="math/tex; mode=display">\begin{align}&k\leq\frac{y_1-y_2}{x_1-x_2}\\&(ğ‘¥_0\frac{ğ‘¦_1âˆ’ğ‘¦_2}{ğ‘¥_1âˆ’ğ‘¥_2}+\frac{ğ‘¥_1 ğ‘¦_2âˆ’ğ‘¥_2 ğ‘¦_1}{ğ‘¥_1âˆ’ğ‘¥_2}âˆ’ğ‘˜ğ‘¥_0 )âˆ’(ğ‘¦_2âˆ’ğ‘˜ğ‘¥_2 )\\&=\frac{ğ‘¥_0 ğ‘¦_1âˆ’ğ‘¥_0 ğ‘¦_2+ğ‘¥_2 ğ‘¦_2âˆ’ğ‘¥_2 ğ‘¦_1}{ğ‘¥_1âˆ’ğ‘¥_2}âˆ’ğ‘˜(ğ‘¥_2âˆ’ğ‘¥_0)\\&=\frac{(ğ‘¥_0âˆ’ğ‘¥_2 )(ğ‘¦_1âˆ’ğ‘¦_2 )}{ğ‘¥_1âˆ’ğ‘¥_2}âˆ’ğ‘˜(ğ‘¥_0âˆ’ğ‘¥_2 )\\&â‰¥\frac{(ğ‘¥_0âˆ’ğ‘¥_2 )(ğ‘¦_1âˆ’ğ‘¦_2 )}{ğ‘¥_1âˆ’ğ‘¥_2}âˆ’\frac{(ğ‘¥_0âˆ’ğ‘¥_2 )(ğ‘¦_1âˆ’ğ‘¦_2 )}{ğ‘¥_1âˆ’ğ‘¥_2}\\&=0\end{align}</script><ul><li>ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨ $ y_1-kx_1 $ å’Œ $ y_2-kx_2 $ ä¸­ä¸€å®šå­˜åœ¨ä¸€ä¸ªæ•°å°äºæˆ–ç­‰äº $ x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-x_2}-kx_0 $ ï¼Œåˆå› ä¸º $ y_0-kx_0&gt;x_0\frac{y_1-y_2}{x_1-x_2}+\frac{x_1 y_2-x_2 y_1}{x_1-x_2}-kx_0 $ ï¼Œæ‰€ä»¥åœ¨ $ y_1-kx_1 $ å’Œ $ y_2-kx_2 $ ä¸­ä¸€å®šå­˜åœ¨ä¸€ä¸ªæ•°å°äº $ y_0-kx_0 $ ï¼ŒçŸ›ç›¾ã€‚</li><li>ç»¼ä¸Šæ‰€è¿°ï¼Œæ­¤æˆªè·çš„æœ€å°å€¼ä¸€å®šå–åœ¨ä¸‹å‡¸åŒ…ä¸Šã€‚</li><li>è¯æ¯•ã€‚</li></ul><h4 id="å›å½’æ­£é¢˜"><a href="#å›å½’æ­£é¢˜" class="headerlink" title="å›å½’æ­£é¢˜"></a>å›å½’æ­£é¢˜</h4><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†æœ€ä¼˜å†³ç­–ç‚¹ä¸€å®šåœ¨ä¸‹å‡¸åŒ…ä¸Š</p><p>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ‰¾æœ€ä¼˜å†³ç­–ç‚¹å‘¢ï¼Ÿ</p><p>é¦–å…ˆæˆ‘ä»¬æ˜“å¾—ä¸‹å‡¸åŒ…ä¸­æ‰€æœ‰çº¿çš„æ–œç‡ä¸€å®šæ˜¯<strong>å•è°ƒé€’å¢</strong>çš„</p><p>å¦‚æœå­˜åœ¨ä¸‰ä¸ªä¸‹å‡¸åŒ…ä¸­çš„ç‚¹ $ (x_1,y_1 ) $ ï¼Œ $ (x_2,y_2 ) $ ï¼Œ $ (x_3,y_3 ) $ ä½¿å¾— $ x_1 &lt; x_2 &lt; x_3 $ ä¸” $ \frac{y_2-y_1}{x_2-x_1} &gt; \frac{y_3-y_2}{x_3-x_2} $ ï¼Œåˆ™ $ y_2 - \frac{y_3-y_1}{x_3-x_1} x_2 - \frac{x_3 y_1-x_1 y_3}{x_3-x_1} = \frac{-x_1 y_2+x_1 y_3+x_2 y_1-x_2 y_3-x_3 y_1+x_3 y_2}{x_3-x_1} $  </p><p>åˆå› ä¸º $ x_1 &lt; x_2 &lt; x_3 $ ï¼Œæ‰€ä»¥ $ x_2-x_1 &gt; 0 $ ï¼Œ $ x_3-x_2 &gt; 0 $ ï¼Œ $ x_3-x_1 &gt; 0 $ </p><p>æ•… $ (y_2-y_1 )(x_3-x_2 )&gt;(y_3-y_2 )(x_2-x_1 ) $ ï¼Œå³ $ x_2 y_1-x_3 y_1+x_3 y_2&gt;x_1 y_2-x_1 y_3+x_2 y_3 $ </p><p>æ‰€ä»¥ $ \frac{-x_1 y_2+x_1 y_3+x_2 y_1-x_2 y_3-x_3 y_1+x_3 y_2}{x_3-x_1}&gt;0 $ ï¼Œæ•… $ y_2&gt;\frac{y_3-y_1}{x_3-x_1} x_2+\frac{x_3 y_1-x_1 y_3}{x_3-x_1} $ ï¼Œæ‰€ä»¥ $ (x_2,y_2 ) $ ä¸€å®šä¸åœ¨ä¸‹å‡¸åŒ…å†…ã€‚</p><p>æ€è·¯å¾ˆæ¸…æ™°äº†å§ï¼Ÿ</p><h3 id="ç®€ç®€å•å•çš„ä»£ç "><a href="#ç®€ç®€å•å•çš„ä»£ç " class="headerlink" title="ç®€ç®€å•å•çš„ä»£ç "></a>ç®€ç®€å•å•çš„ä»£ç </h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;cstdio&gt;using namespace std;const int N &#x3D; 5e4 + 5;int n, L, C, Qt[N], h &#x3D; 1, t;ll sum[N], f[N], Qx[N], Qy[N];il ll sq(ll x) &#123;return x * x;&#125;il double sl(ll x1, ll y1, ll x2, ll y2) &#123;return (double) (y1 - y2) &#x2F; (x1 - x2);&#125;int main() &#123; scanf(&quot;%d%d%d&quot;, &amp;n, &amp;L, &amp;C);sum[1] &#x3D; C; f[1] &#x3D; sq(C - L);Qt[++t] &#x3D; 0; Qx[t] &#x3D; L + 1; Qy[t] &#x3D; sq(Qx[t]);Qt[++t] &#x3D; 1; Qx[t] &#x3D; L + 2 + C; Qy[t] &#x3D; f[1] + sq(Qx[t]);for(int i &#x3D; 2; i &lt;&#x3D; n; ++i) &#123;scanf(&quot;%d&quot;, &amp;C);sum[i] &#x3D; sum[i - 1] + C;double slope &#x3D; (i + sum[i]) &lt;&lt; 1;while(h &lt; t &amp;&amp; sl(Qx[h], Qy[h], Qx[h + 1], Qy[h + 1]) &lt; slope) ++h;f[i] &#x3D; f[Qt[h]] + sq(i - Qt[h] - 1 + sum[i] - sum[Qt[h]] - L);ll X &#x3D; i + sum[i] + L + 1, Y &#x3D; f[i] + sq(X);while(h &lt; t &amp;&amp; sl(Qx[t], Qy[t], Qx[t - 1], Qy[t - 1]) &gt;&#x3D; sl(Qx[t], Qy[t], X, Y)) --t; Qt[++t] &#x3D; i; Qx[t] &#x3D; X, Qy[t] &#x3D; Y;&#125;printf(&quot;%lld\n&quot;, f[n]);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é—®é¢˜æ¥äº†"><a href="#é—®é¢˜æ¥äº†" class="headerlink" title="é—®é¢˜æ¥äº†"></a>é—®é¢˜æ¥äº†</h2><p>è‹¥ $ C_k $ å¯ä»¥å°äº0å‘¢ï¼Ÿåˆè¯¥æ€ä¹ˆåšï¼Ÿ</p><p>è¿™ä¸ªæˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹ç©¿è¿™ç©æ„<strong>ä¸æ»¡è¶³å•è°ƒæ€§</strong>ã€‚</p><p>å‡å¦‚è¯´è€ƒè¯•çš„æ—¶å€™ä½ ä¸ä¼šè¯æ–œç‡çš„ç‚¹æˆ–è€…å†³ç­–æœ‰/æ²¡æœ‰å•è°ƒæ€§æ€ä¹ˆåŠï¼Ÿ</p><p>æœ‰ä¸¤ç§æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ˜¯æ‰“è¡¨ï¼Œå¤šæ‰“å‡ ç»„ã€‚</p><p>ç¬¬äºŒç§æ˜¯ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ç›´æ¥ä¸Šä¸æ»¡è¶³å•è°ƒæ€§æ—¶çš„åšæ³•ã€‚åæ­£æ»¡è¶³å•è°ƒæ€§çš„æ—¶å€™ä¸æ»¡è¶³å•è°ƒæ€§æ—¶çš„åšæ³•ä¹Ÿèƒ½ç”¨ã€‚</p><p>ä¸æ»¡è¶³å•è°ƒæ€§çš„åšæ³•ï¼š</p><h3 id="åˆ†æ²»"><a href="#åˆ†æ²»" class="headerlink" title="åˆ†æ²»"></a>åˆ†æ²»</h3><p>æˆ‘ä»¬ç”¨ $ dc(l, r) $ è¡¨ç¤ºè®¡ç®— $ [l, r] $ ä¸­çš„ $ dp_i $ ã€‚</p><p>å¯¹äºå·¦åŠè¾¹ï¼Œæˆ‘ä»¬å…ˆç”¨ $ dc(l, mid) $ ç®—å‡º $ [l, mid] $ ä¸­çš„ $ dp_i $ ã€‚ç„¶åæˆ‘ä»¬å°±çŸ¥é“äº†æ‰€æœ‰çš„å†³ç­–ç‚¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥å»ºå‡¸åŒ…ã€‚ç„¶åæˆ‘ä»¬ç”¨è¿™ä¸ªå‡¸åŒ…å»æ›´æ–° $ [mid, r] $ ä¸­çš„ $ dp_i $ ã€‚è¿™æ—¶çš„å‡¸åŒ…æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠ $ [mid, r] $ çš„æŸ¥è¯¢æ–œç‡æ’åºï¼Œç„¶åç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å‡¸åŒ…ä¸ŠäºŒåˆ†ã€‚</p><p>å¯¹äº $ [mid, r] $ ä¸­çš„æ¯ä¸ª $ dp_i $ ï¼Œå¦‚æœå®ƒçš„æœ€ä¼˜å†³ç­–ç‚¹åœ¨ $ [1, mid] $ ï¼Œåˆ™ä¸Šä¸€æ­¥å·²ç»æ›´æ–°å®Œï¼Œå¦‚æœå®ƒçš„æœ€ä¼˜å†³ç­–ç‚¹ä¸åœ¨ $ [l, mid] $ æˆ‘ä»¬ä¹Ÿä¸éœ€è¦ $ [l, mid] $ çš„å‡¸åŒ…ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠå·¦è¾¹çš„å‡¸åŒ…æŠ›æ‰ï¼Œç”¨ $ dc(mid + 1, r) $ è®¡ç®—ä¹‹åçš„ $ dp_i $ ã€‚</p><p> $ T(n)=2T(\frac{n}{2})+O(n\log n))=O(n\log^2n) $ </p><h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;vector&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;algorithm&gt;int n, h[100005], w[100005], pre[100005];long long dp[100005], sum[100005];struct Point &#123;long long x, y;int id;Point(long long _x, long long _y, int _id): x(_x), y(_y), id(_id) &#123;&#125;double operator&#x2F; (const Point &amp;p) const &#123; return (double) (y - p.y) &#x2F; (x - p.x); &#125;&#125;;long long min(long long a, long long b) &#123; return a &lt; b ? a : b; &#125;void cdq(int l, int r) &#123;while (l !&#x3D; r) &#123;std::vector&lt;Point&gt; Q, temp;int mid &#x3D; (l + r) &gt;&gt; 1;cdq(l, mid);for (int i &#x3D; l; i &lt;&#x3D; mid; ++i)temp.push_back(Point(h[i], dp[i] + (long long) h[i] * h[i] - sum[i], i));std::sort(temp.begin(), temp.end(), [] (const Point &amp;p1, const Point &amp;p2) &#123;return p1.x &#x3D;&#x3D; p2.x ? p1.y &lt; p2.y : p1.x &lt; p2.x;&#125;);Q.push_back(temp[0]); int _size &#x3D; 0;for (int i &#x3D; 1; i &lt; (int) temp.size(); ++i) &#123;if (Q[_size].x &#x3D;&#x3D; temp[i].x) continue;while (_size &amp;&amp; Q[_size] &#x2F; Q[_size - 1] &gt; Q[_size] &#x2F; temp[i]) Q.pop_back(), --_size;Q.push_back(temp[i]); ++_size;&#125;for (int i &#x3D; r; i &gt; mid; --i) &#123;int l &#x3D; 1, r &#x3D; Q.size() - 1, sl &#x3D; h[i] &lt;&lt; 1;while (l &lt;&#x3D; r) &#123;int mid &#x3D; (l + r) &gt;&gt; 1;if (Q[mid] &#x2F; Q[mid - 1] &gt; sl) r &#x3D; mid - 1;else l &#x3D; mid + 1;&#125;int k &#x3D; Q[r].id;dp[i] &#x3D; min(dp[i], dp[k] + (long long) (h[i] - h[k]) * (h[i] - h[k]) + sum[i - 1] - sum[k]);&#125;l &#x3D; mid + 1;&#125;&#125;int main() &#123;scanf(&quot;%d&quot;, &amp;n);for (int i &#x3D; 1; i &lt;&#x3D; n; ++i) scanf(&quot;%d&quot;, h + i);for (int i &#x3D; 1; i &lt;&#x3D; n; ++i) scanf(&quot;%d&quot;, w + i), sum[i] &#x3D; sum[i - 1] + w[i];memset(dp, 0x3f, sizeof dp); dp[1] &#x3D; 0;cdq(1, n); printf(&quot;%lld\n&quot;, dp[n]);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¹³è¡¡æ ‘"><a href="#å¹³è¡¡æ ‘" class="headerlink" title="å¹³è¡¡æ ‘"></a>å¹³è¡¡æ ‘</h3><p>æ€è·¯å¾ˆç®€æ´ï¼Œä¸€è¯´å°±æ‡‚ï¼Œä¸€å†™å°±åºŸ</p><h4 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;stdio.h&gt;#include &lt;string.h&gt;inline unsigned rand() &#123;static unsigned seed &#x3D; 19260817;return (seed &#x3D; seed * 1279u + 10001279u) ^&#x3D; (seed &gt;&gt; 7);&#125;struct Point &#123;long long x, y;int id;Point(long long _x, long long _y, int _id): x(_x), y(_y), id(_id) &#123;&#125;Point() &#123;&#125;double operator&#x2F; (const Point &amp;p) const &#123; return (double) (y - p.y) &#x2F; (x - p.x); &#125;&#125;;struct Treap &#123;struct node &#123;int ls, rs, size;Point p;double lp, rp;unsigned key;&#125; tr[100005];int cnt, root;inline int new_node(const Point &amp;p) &#123;tr[++cnt].p &#x3D; p;tr[cnt].key &#x3D; rand();tr[cnt].size &#x3D; 1;return cnt;&#125;inline void push_up(int k) &#123; if (k) tr[k].size &#x3D; tr[tr[k].ls].size + tr[tr[k].rs].size + 1; &#125;void rotate_left(int &amp;k) &#123;int old_k &#x3D; k;k &#x3D; tr[k].rs;tr[old_k].rs &#x3D; tr[k].ls;tr[k].ls &#x3D; old_k;push_up(old_k);push_up(k);&#125;void rotate_right(int &amp;k) &#123;int old_k &#x3D; k;k &#x3D; tr[k].ls;tr[old_k].ls &#x3D; tr[k].rs;tr[k].rs &#x3D; old_k;push_up(old_k);push_up(k);&#125;int insert(int &amp;k, const Point &amp;v) &#123;int tmp;if (!k) &#123; return k &#x3D; new_node(v); &#125;if (v.x &lt; tr[k].p.x) &#123;if (tmp &#x3D; insert(tr[k].ls, v)) &#123;if (tr[k].key &gt; tr[tr[k].ls].key) rotate_right(k);push_up(k);return tmp;&#125; else return 0;&#125; else if (v.x &gt; tr[k].p.x) &#123;if (tmp &#x3D; insert(tr[k].rs, v)) &#123;if (tr[k].key &gt; tr[tr[k].rs].key) rotate_left(k);push_up(k);return tmp;&#125; else return 0;&#125; else &#123;if (tr[k].p.y &lt; v.y) return 0;tr[k].p.y &#x3D; v.y; tr[k].p.id &#x3D; v.id; return k;&#125;&#125;void remove(int &amp;k, long long x) &#123;if (!k) return;if (tr[k].p.x &#x3D;&#x3D; x) &#123;if (tr[k].ls &amp;&amp; tr[k].rs) &#123;if (tr[tr[k].ls].key &lt; tr[tr[k].rs].key) rotate_right(k), remove(tr[k].rs, x);else rotate_left(k), remove(tr[k].ls, x);&#125; else k &#x3D; tr[k].ls | tr[k].rs;&#125; else if (x &lt; tr[k].p.x) remove(tr[k].ls, x);else remove(tr[k].rs, x);push_up(k);&#125;int rank(long long x) &#123;int rnk &#x3D; 0, k &#x3D; root;while (k) &#123;if (x &lt;&#x3D; tr[k].p.x) k &#x3D; tr[k].ls;else rnk +&#x3D; tr[tr[k].ls].size + 1, k &#x3D; tr[k].rs;&#125;return rnk + 1;&#125;int value(int x) &#123;if (x &gt; tr[root].size || x &lt;&#x3D; 0) return -1;int k &#x3D; root;while (k) &#123;if (x &lt;&#x3D; tr[tr[k].ls].size) k &#x3D; tr[k].ls;else if (x &#x3D;&#x3D; tr[tr[k].ls].size + 1) return k;else x -&#x3D; tr[tr[k].ls].size + 1, k &#x3D; tr[k].rs;&#125;return -1;&#125;int prev(long long v) &#123; return value(rank(v) - 1); &#125;int next(long long v) &#123; return value(rank(v + 1)); &#125; void insert_hull(const Point &amp;point) &#123;int k &#x3D; insert(root, point);if (!k) return;int k1 &#x3D; prev(point.x);if (k1 !&#x3D; -1) &#123;while (tr[k1].lp &gt; point &#x2F; tr[k1].p) remove(root, tr[k1].p.x), k1 &#x3D; prev(tr[k1].p.x);tr[k].lp &#x3D; tr[k1].rp &#x3D; point &#x2F; tr[k1].p;&#125; else tr[k].lp &#x3D; -1e30;int k2 &#x3D; next(point.x);if (k2 !&#x3D; -1) &#123;while (point &#x2F; tr[k2].p &gt; tr[k2].rp)remove(root, tr[k2].p.x), k2 &#x3D; next(tr[k2].p.x);tr[k].rp &#x3D; tr[k2].lp &#x3D; tr[k2].p &#x2F; point;&#125; else tr[k].rp &#x3D; 1e30;if (tr[k].lp &gt; tr[k].rp) &#123;remove(root, tr[k].p.x);tr[k1].rp &#x3D; tr[k2].lp &#x3D; tr[k1].p &#x2F; tr[k2].p;&#125;&#125;int query_hull(long long slope) &#123;int k &#x3D; root;while (k) &#123;if (tr[k].lp &lt;&#x3D; slope &amp;&amp; slope &lt;&#x3D; tr[k].rp) return tr[k].p.id;else if (slope &lt; tr[k].lp) k &#x3D; tr[k].ls;else k &#x3D; tr[k].rs;&#125;return -1;&#125;&#125; treap;int n, w[100005], h[100005];long long sum[100005], dp[100005];long long min(long long a, long long b) &#123; return a &lt; b ? a : b; &#125;int main() &#123;scanf(&quot;%d&quot;, &amp;n);for (int i &#x3D; 1; i &lt;&#x3D; n; ++i) scanf(&quot;%d&quot;, h + i);for (int i &#x3D; 1; i &lt;&#x3D; n; ++i) scanf(&quot;%d&quot;, w + i), sum[i] &#x3D; sum[i - 1] + w[i];memset(dp, 0x3f, sizeof dp); dp[1] &#x3D; 0;treap.new_node(Point(h[1], (long long) h[1] * h[1] - w[1], 1));treap.root &#x3D; 1; treap.tr[1].lp &#x3D; -1e30; treap.tr[1].rp &#x3D; 1e30;for (int i &#x3D; 2; i &lt;&#x3D; n; ++i) &#123;int j &#x3D; treap.query_hull(h[i] &lt;&lt; 1);dp[i] &#x3D; min(dp[i], dp[j] + (long long) (h[i] - h[j]) * (h[i] - h[j]) + sum[i - 1] - sum[j]);treap.insert_hull(Point(h[i], dp[i] + (long long) h[i] * h[i] - sum[i], i));&#125;printf(&quot;%lld&quot;, dp[n]);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="äºŒè¿›åˆ¶åˆ†ç»„"><a href="#äºŒè¿›åˆ¶åˆ†ç»„" class="headerlink" title="äºŒè¿›åˆ¶åˆ†ç»„"></a>äºŒè¿›åˆ¶åˆ†ç»„</h3><p>æˆ‘ä»¬å°†æ‰€æœ‰çš„ç‚¹åˆ†æˆè‹¥å¹²ç»„ï¼Œç¬¬ $ i $ ç»„å¤§å°ä¸º $ 2^i $ ï¼Œæ˜¾ç„¶ç»„æ•°ä¸è¶…è¿‡ $ O(\log n) $ ã€‚æˆ‘ä»¬ç»´æŠ¤æ¯ç»„çš„å‡¸åŒ…ã€‚</p><p>æ’å…¥ä¸€ä¸ªç‚¹æ—¶ï¼Œè‹¥æ²¡æœ‰ç¬¬0ç»„ï¼Œåˆ™å°†å®ƒä½œä¸ºç¬¬0ç»„ï¼Œå¦åˆ™å°†å®ƒå’Œç¬¬0ç»„åˆå¹¶ã€‚è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†ç¬¬1ç»„ã€‚æ¥ä¸‹æ¥å¦‚æœæœ‰ç¬¬1ç»„ï¼Œåˆ™å†å°†å®ƒä¸ç¬¬1ç»„åˆå¹¶å¾—åˆ°ç¬¬2ç»„â€¦â€¦ç±»ä¼¼äºŒè¿›åˆ¶+1çš„è¿‡ç¨‹ã€‚</p><p>æŸ¥è¯¢åœ¨æ¯ä¸€ç»„åˆ†åˆ«äºŒåˆ†ï¼Œå–æœ€å¤§å³å¯ã€‚</p><p>å…³äºæ—¶é—´å¤æ‚åº¦ï¼š</p><p>æ˜¾ç„¶æ¯ä¸ªç‚¹æœ€å¤šè¢«åˆå¹¶ $ O(\log â¡n) $ æ¬¡ã€‚æˆ‘ä»¬åˆå¹¶ä¸¤ä¸ªåŒ…å« $ O(n) $ ä¸ªèŠ‚ç‚¹çš„å‡¸åŒ…çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $ O(n) $ çš„ï¼Œæ•…å‡æ‘Šåˆ°æ¯ä¸ªç‚¹ä¸Šåˆå¹¶çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $ O(1) $ ï¼Œåˆå› ä¸ºå…±æœ‰ $ O(n) $ ä¸ªç‚¹ï¼Œæ‰€ä»¥æ€»æ—¶é—´å¤æ‚åº¦ $ O(n\logâ¡ n) $ ã€‚</p><h4 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;string.h&gt;#include &lt;stdio.h&gt;#include &lt;vector&gt;int n, h[100005], w[100005];long long dp[100005], sum[100005];struct Point &#123;long long x, y;int id;Point(long long _x, long long _y, int _id): x(_x), y(_y), id(_id) &#123;&#125;double operator&#x2F; (const Point &amp;p) const &#123; return (double) (y - p.y) &#x2F; (x - p.x); &#125;&#125;;struct ConvexHull &#123;std::vector&lt;Point&gt; p;void merge(ConvexHull &amp;h) &#123;std::vector&lt;Point&gt; possible_conv;int i &#x3D; 0, j &#x3D; 0;while (i &lt; (int) p.size() &amp;&amp; j &lt; (int) h.p.size())if (p[i].x &#x3D;&#x3D; h.p[j].x) &#123;if (p[i].y &lt; h.p[j].y) possible_conv.push_back(p[i]);else possible_conv.push_back(h.p[j]);++i; ++j;&#125; else if (p[i].x &lt; h.p[j].x) possible_conv.push_back(p[i]), ++i;else possible_conv.push_back(h.p[j]), ++j;while (i &lt; (int) p.size()) possible_conv.push_back(p[i]), ++i;while (j &lt; (int) h.p.size()) possible_conv.push_back(h.p[j]), ++j;p.clear(); p.push_back(possible_conv[0]);int _size &#x3D; 0;for (int i &#x3D; 1; i &lt; (int) possible_conv.size(); ++i) &#123;while (_size &amp;&amp; p[_size] &#x2F; p[_size - 1] &gt; p[_size] &#x2F; possible_conv[i]) p.pop_back(), --_size;p.push_back(possible_conv[i]); ++_size;&#125;h.p.clear();&#125;int query(long long k) &#123;int l &#x3D; 1, r &#x3D; p.size() - 1;while (l &lt;&#x3D; r) &#123;int mid &#x3D; (l + r) &gt;&gt; 1;if (p[mid] &#x2F; p[mid - 1] &gt; k) r &#x3D; mid - 1;else l &#x3D; mid + 1;&#125;return p[r].id;&#125;ConvexHull() &#123;&#125;ConvexHull(const Point &amp;P) &#123; p.push_back(P); &#125;&#125; conv[17];long long min(long long a, long long b) &#123; return a &lt; b ? a : b; &#125;int main() &#123;scanf(&quot;%d&quot;, &amp;n);for (int i &#x3D; 1; i &lt;&#x3D; n; ++i) scanf(&quot;%d&quot;, h + i);for (int i &#x3D; 1; i &lt;&#x3D; n; ++i) scanf(&quot;%d&quot;, w + i), sum[i] &#x3D; sum[i - 1] + w[i];memset(dp, 0x3f, sizeof dp); dp[1] &#x3D; 0;conv[0] &#x3D; ConvexHull(Point(h[1], (long long) h[1] * h[1] - w[1], 1));for (int i &#x3D; 2; i &lt;&#x3D; n; ++i) &#123;for (int j &#x3D; 0; j &lt; 17; ++j) &#123;if (conv[j].p.empty()) continue;int k &#x3D; conv[j].query(h[i] &lt;&lt; 1);dp[i] &#x3D; min(dp[i], dp[k] + (long long) (h[i] - h[k]) * (h[i] - h[k]) + sum[i - 1] - sum[k]);&#125;ConvexHull cv(Point(h[i], dp[i] + (long long) h[i] * h[i] - sum[i], i));for (int j &#x3D; 0; j &lt; 17; ++j) &#123;if (conv[j].p.empty()) &#123;conv[j].p &#x3D; cv.p;break;&#125;cv.merge(conv[j]);&#125;&#125;printf(&quot;%lld&quot;, dp[n]);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨ $ dp $ çš„æœ€å°/æœ€å¤§åŒ–é—®é¢˜ä¸­ï¼Œå°†è½¬ç§»æ–¹ç¨‹åˆ†æˆå››éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†ä¸ $ i, j $ éƒ½æ— å…³ï¼Œä¸€éƒ¨åˆ†åªä¸ $ j $ æœ‰å…³ï¼Œä¸€éƒ¨åˆ†åªä¸ $ i $ æœ‰å…³ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†å’Œ $ i, j $ éƒ½æœ‰å…³ã€‚å¦‚æœå®ƒèƒ½å†™æˆ  $ y=kx+b $  çš„å½¢å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå‡¸åŒ…ï¼Œæ¥è¿›è¡ŒçŠ¶æ€çš„è½¬ç§»ã€‚</p><p><strong>æ€ä¹ˆæ ·ï¼Œä½ å­¦ä¼š(åºŸ)äº†å—</strong></p><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><blockquote><p>æ­¤å¤„æ”¾å‡ºä½ è°·çš„é“¾æ¥</p></blockquote><ul><li><a href="https://www.luogu.com.cn/problem/P4655">P4655 / loj 2483 Building Bridges</a></li><li><a href="https://www.luogu.com.cn/problem/P5017">P5017 / loj 3007 [NOIP2018 æ™®åŠç»„] æ‘†æ¸¡è½¦</a></li><li><a href="https://www.luogu.com.cn/problem/P4027">P4027 / loj 2353 [NOI2007] è´§å¸å…‘æ¢</a></li><li><a href="https://www.luogu.com.cn/problem/P3571">P3571 [POI2014] SUP-Supercomputer</a></li><li><a href="https://www.luogu.com.cn/problem/CF311B">CF311B Cats Transport</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ–œç‡ä¼˜åŒ–-dp&quot;&gt;&lt;a href=&quot;#æ–œç‡ä¼˜åŒ–-dp&quot; class=&quot;headerlink&quot; title=&quot;æ–œç‡ä¼˜åŒ– $ dp $&quot;&gt;&lt;/a&gt;æ–œç‡ä¼˜åŒ– $ dp $&lt;/h1&gt;&lt;h2 id=&quot;å‰ç½®çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#å‰ç½®çŸ¥è¯†&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="æ•™ç¨‹" scheme="http://www.honahec.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="C++" scheme="http://www.honahec.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>çŸ©é˜µ</title>
    <link href="http://www.honahec.com/ju-zhen/"/>
    <id>http://www.honahec.com/ju-zhen/</id>
    <published>2021-06-25T13:52:15.000Z</published>
    <updated>2021-09-17T12:45:11.494Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h1><h2 id="çŸ©é˜µ-Matrix-å®šä¹‰"><a href="#çŸ©é˜µ-Matrix-å®šä¹‰" class="headerlink" title="çŸ©é˜µ(Matrix)å®šä¹‰"></a>çŸ©é˜µ(Matrix)å®šä¹‰</h2><p>ä¸€ä¸ª  $ n\times m $  çš„çŸ©é˜µæ˜¯ä¸€ä¸ªç”±  $ n $  è¡Œ  $ m $  åˆ—å…ƒç´ æ’æˆçš„çŸ©å½¢é˜µåˆ—ã€‚çŸ©é˜µé‡Œçš„å…ƒç´ å¯ä»¥æ˜¯æ•°å­—ç¬¦å·æˆ–è€…æ•°å­¦å¼ã€‚</p><p>å½¢å¦‚ $ \left(\begin{matrix}a&amp;b\\c&amp;d\end{matrix}\right) $ çš„æ•°è¡¨ç§°ä¸º<strong>äºŒé˜¶çŸ©é˜µ</strong>ï¼Œå®ƒç”±äºŒè¡ŒäºŒåˆ—ç»„æˆï¼Œå…¶ä¸­ $ a,b,c,d $ ç§°ä¸ºè¿™ä¸ªçŸ©é˜µçš„å…ƒç´ ã€‚</p><p>å½¢å¦‚ $ \left(\begin{matrix}x_1\\x_2\end{matrix}\right) $ çš„æœ‰åºå¯¹ç§°ä¸º<strong>åˆ—å‘é‡(Column Vector)</strong></p><h2 id="çŸ©é˜µåŠ æ³•"><a href="#çŸ©é˜µåŠ æ³•" class="headerlink" title="çŸ©é˜µåŠ æ³•"></a>çŸ©é˜µåŠ æ³•</h2><p>çŸ©é˜µçš„åŠ æ³•éå¸¸ç®€å•</p><p>å¯¹ï¼Œå°±æ˜¯ä½ æƒ³çš„é‚£æ ·</p><script type="math/tex; mode=display">\left(\begin{matrix}a_{1,1}&a_{1,2}&\cdots&a_{1,m}\\a_{2,1}&a_{2,1}&\cdots&a_{2,m}\\\vdots&\vdots&&\vdots\\a_{n,1}&a_{n,2}&\cdots&a_{n,m}\end{matrix}\right)\pm\left(\begin{matrix}b_{1,1}&b_{1,2}&\cdots&b_{1,m}\\b_{2,1}&b_{2,1}&\cdots&b_{2,m}\\\vdots&\vdots&&\vdots\\b_{n,1}&b_{n,2}&\cdots&b_{n,m}\end{matrix}\right)=\left(\begin{matrix}a_{1,1}\pm b_{1,1}&a_{1,2}\pm b_{1,2}&\cdots&a_{1,m}\pm b_{1,m}\\a_{2,1}\pm b_{2,1}&a_{2,1}\pm b_{2,2}&\cdots&a_{2,m}\pm b_{2, m}\\\vdots&\vdots&&\vdots\\a_{n,1}\pm b_{n,1}&a_{n,1}\pm b_{n,2}&\cdots&a_{n,m}\pm b_{n,m}\end{matrix}\right)</script><p>æ³¨æ„ï¼šä¸¤ä¸ªçŸ©é˜µå¿…é¡»ä¸º<strong>åŒå‹çŸ©é˜µ</strong>(å³å¿…é¡»éƒ½æ˜¯  $ n\times m $  çš„çŸ©é˜µ)æ‰èƒ½ç›¸åŠ </p><p>å¹¶ä¸”ï¼ŒçŸ©é˜µåŠ å‡æ³•<strong>æ»¡è¶³</strong>äº¤æ¢å¾‹å’Œç»“åˆå¾‹(å³ $ A+B=B+A $ ï¼Œ $ (A+B)+C=A+(B+C) $ )</p><h2 id="çŸ©é˜µä¹˜æ³•"><a href="#çŸ©é˜µä¹˜æ³•" class="headerlink" title="çŸ©é˜µä¹˜æ³•"></a>çŸ©é˜µä¹˜æ³•</h2><p>çŸ©é˜µä¹˜æ³•<strong>ç¨æœ‰</strong>ä¸åŒ</p><p>å—¯ï¼ŒçœŸçš„åªæœ‰ä¸€ç‚¹ä¸åŒ</p><p>å¦‚æœæœ‰çŸ©é˜µ  $ A $  å¤§å°ä¸º  $ n\times m $  ï¼ŒçŸ©é˜µ  $ B $  å¤§å°ä¸º  $ m\times s $  ï¼Œç›¸ä¹˜ä¸ºçŸ©é˜µ  $ C $ ï¼ŒçŸ©é˜µ  $ C $  çš„å¤§å°ä¸€å®šä¸º  $ n\times s $ </p><p>çŸ©é˜µä¹˜æ³•éµå¾ª  $ C=\sum_{k=1}^{m}a_{i,k}b_{k,j} $ </p><p>å—¯ï¼Œåªæœ‰ä¸€ç‚¹</p><h3 id="ä¸¾ä¸ªä¾‹å­"><a href="#ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ä¸¾ä¸ªä¾‹å­"></a>ä¸¾ä¸ªä¾‹å­</h3><p>è®¾</p><script type="math/tex; mode=display">\begin{align}A&=\left(\begin{matrix}a&b\\c&d\end{matrix}\right)\\\\B&=\left(\begin{matrix}x_1\\x_2\end{matrix}\right)\\\end{align}</script><p>åˆ™</p><script type="math/tex; mode=display">\begin{align}C=AB&=\left(\begin{matrix}ax_1+bx_2\\cx_1+dx_2\end{matrix}\right)\\\end{align}</script><p>ç§°ä¸ºäºŒé˜¶çŸ©é˜µ  $ A $  ä¸å¹³é¢å‘é‡  $ B $  çš„ä¹˜ç§¯ï¼Œè®°ä¸º  $ AB=C $ </p><h2 id="åˆ©ç”¨çŸ©é˜µæ±‚æ–æ³¢é‚£å¥‘-Fibonacci-æ•°åˆ—"><a href="#åˆ©ç”¨çŸ©é˜µæ±‚æ–æ³¢é‚£å¥‘-Fibonacci-æ•°åˆ—" class="headerlink" title="åˆ©ç”¨çŸ©é˜µæ±‚æ–æ³¢é‚£å¥‘(Fibonacci)æ•°åˆ—"></a>åˆ©ç”¨çŸ©é˜µæ±‚æ–æ³¢é‚£å¥‘(Fibonacci)æ•°åˆ—</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæ–æ³¢é‚£å¥‘æ•°åˆ—ä»ç¬¬ä¸‰é¡¹å¼€å§‹ï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯å‰ä¸¤é¡¹ä¹‹å’Œ</p><p>å³ $ F_n=F_{n-1}+F_{n-2},n\geq3 $ </p><p>ç‰¹åˆ«çš„ $ F_0=0,F_1=F_2=1 $ </p><p>æŠŠæ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­ç›¸é‚»çš„ä¸¤é¡¹(  $ F_n $  å’Œ  $ F_{n-1} $  )å†™æˆä¸€ä¸ª $ 2\times1 $ çš„çŸ©é˜µ</p><script type="math/tex; mode=display">\begin{align}&=\left(\begin{matrix}F_n\\ F_{n-1}\end{matrix}\right)\\\\&=\left(\begin{matrix}F_{n-1}+F_{n-2}\\ F_{n-1}\end{matrix}\right)\\\\&=\left(\begin{matrix}1\times F_{n-1}+1\times F_{n-2}\\ 1\times F_{n-1}+0\times F_{n-2}\end{matrix}\right)\\\\&=\left(\begin{matrix}1&1\\ 1&0\end{matrix}\right)\times \left(\begin{matrix}F_{n-1}\\ F_{n-2}\end{matrix}\right)\\\\&=\left(\begin{matrix}1&1\\ 1&0\end{matrix}\right)^{n-1}\times \left(\begin{matrix}F_1\\ F_0\end{matrix}\right)\\\\&=\left(\begin{matrix}1&1\\ 1&0\end{matrix}\right)^{n-1}\times \left(\begin{matrix}1\\ 0\end{matrix}\right)\end{align}</script><p>æ±‚  $ F_n $  ç­‰åŒäºæ±‚äºŒé˜¶çŸ©é˜µçš„  $ n-1 $  æ¬¡æ–¹ï¼Œç»“æœå–çŸ©é˜µç¬¬ä¸€è¡Œå…ƒç´ ã€‚</p><p>é—®é¢˜è½¬æ¢ä¸ºäºŒé˜¶çŸ©é˜µçš„  $ n $  æ¬¡å¹‚</p><h3 id="æ±‚äºŒé˜¶çŸ©é˜µçš„-N-æ¬¡å¹‚"><a href="#æ±‚äºŒé˜¶çŸ©é˜µçš„-N-æ¬¡å¹‚" class="headerlink" title="æ±‚äºŒé˜¶çŸ©é˜µçš„  $ N $  æ¬¡å¹‚"></a>æ±‚äºŒé˜¶çŸ©é˜µçš„  $ N $  æ¬¡å¹‚</h3><p>è¿™é‡Œå¯ä»¥å›é¡¾ä¸€ä¸‹<a href="#toc-heading-3">çŸ©é˜µä¹˜æ³•</a></p><p><strong>å‡è®¾è®¡ç®—çŸ©é˜µ  $ A $  çš„  $ N $  æ¬¡å¹‚</strong></p><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>äºŒé˜¶çŸ©é˜µçš„ä¹˜æ³•æ»¡è¶³ç»“åˆå¾‹</p><p>è®¾ $ A,B,C $ éƒ½æ˜¯ä»»æ„çš„äºŒé˜¶çŸ©é˜µ</p><p>åˆ™ $ A(BC)=(AB)C $ </p><blockquote><p>ä¸åœ¨æ­¤è¯æ˜</p></blockquote><p>è®¾ $ n=N\div 2 $  (ç»“æœå‘ä¸‹å–æ•´)</p><p>è‹¥  $ N\in 2k $  åˆ™  $ A^N=A^n\times A^n $ </p><p>è‹¥  $ N\in 2k+1 $  åˆ™  $ A^N=A^n\times A^n\times A $ </p><blockquote><p>è¿™æ ·å¯ä»¥å‡å°‘è®¡ç®—æ¬¡æ•°ï¼Œè‡ªè¡Œæ€è€ƒåŸå› </p></blockquote><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>ä»¥è®¡ç®—  $ A^6 $  ä¸ºä¾‹</p><p>ä¾‹å¦‚ $ 6_{(10)}=110_{(2)} $ </p><p>åˆ™  $ A^6=A^4\times A^2 $ </p><p><img src="https://z3.ax1x.com/2021/06/15/2qY2uV.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/06/15/2qY2uV.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="äºŒè¿›åˆ¶ä½"></p><p>ä¸Šå›¾æ˜¾ç¤ºäºŒè¿›åˆ¶ä¸å¹‚çš„æŒ‡æ•°å…³ç³»</p><p>äºŒè¿›ä½ä¸º1éœ€è¦ä¹˜ï¼Œä¸º0ä¸éœ€è¦ä¹˜</p><p>å†ä¾‹å¦‚ $ 7_{(10)}=111_{(2)} $ </p><p>åˆ™ $ A^7=A^4\times A^2\times A^1 $ </p><p>å…ˆéšéšä¾¿ä¾¿å†™ä¸€ä¸ªæ±‚å¿«é€Ÿå¹‚çš„ä»£ç (<del>ç›¸ä¿¡å¤§å®¶éƒ½ä¼šå†™å§</del></p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">int qpow(int a, int k) &#123;    int res &#x3D; 1;    while(k) &#123;        if(a &amp; 1) res *&#x3D; a;        k &gt;&gt;&#x3D; 1;        a *&#x3D; a;    &#125;    return res;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆåˆ°åº•æ€ä¹ˆç”¨çŸ©é˜µæ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—å‘¢ï¼Ÿ</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;cstdio&gt;#include&lt;cstring&gt;struct Matrix &#123;long long fib[2][2];Matrix() &#123;memset(fib, 0, sizeof fib);&#125;&#125;;Matrix qmul(Matrix &amp;a, Matrix &amp;b) &#123;Matrix c;for(int i &#x3D; 0; i &lt; 2; ++i) &#123;for(int j &#x3D; 0; j &lt; 2; ++j) &#123;for(int k &#x3D; 0; k &lt; 2; ++k) &#123;c.fib[i][j] +&#x3D; a.fib[i][k] * b.fib[k][j];&#125;&#125;&#125;return c;&#125;Matrix qpow(Matrix a, long long k) &#123;Matrix ans;ans.fib[0][0] &#x3D; ans.fib[1][1] &#x3D; 1;while(k) &#123;if(k &amp; 1) ans &#x3D; qmul(ans, a);a &#x3D; qmul(a, a);k &gt;&gt;&#x3D; 1;&#125;return ans;&#125;int main() &#123;long long n;Matrix a, b;scanf(&quot;%lld&quot;, &amp;n);a.fib[0][0] &#x3D; a.fib[0][1] &#x3D; a.fib[1][0] &#x3D; 1;b &#x3D; qpow(a, n);printf(&quot;%lld\n&quot;, b.fib[0][1]);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½ å­¦ <del>åºŸ</del> ä¼šäº†å—</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;çŸ©é˜µ&quot;&gt;&lt;a href=&quot;#çŸ©é˜µ&quot; class=&quot;headerlink&quot; title=&quot;çŸ©é˜µ&quot;&gt;&lt;/a&gt;çŸ©é˜µ&lt;/h1&gt;&lt;h2 id=&quot;çŸ©é˜µ-Matrix-å®šä¹‰&quot;&gt;&lt;a href=&quot;#çŸ©é˜µ-Matrix-å®šä¹‰&quot; class=&quot;headerlink&quot; title=&quot;çŸ©</summary>
      
    
    
    
    <category term="æ•™ç¨‹" scheme="http://www.honahec.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="C++" scheme="http://www.honahec.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>æ‰“é¼¹é¼ </title>
    <link href="http://www.honahec.com/da-yan-shu/"/>
    <id>http://www.honahec.com/da-yan-shu/</id>
    <published>2021-06-25T13:51:07.000Z</published>
    <updated>2021-09-17T12:45:11.487Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://www.luogu.com.cn/problem/P2285">P2285 æ‰“é¼¹é¼ </a></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€é“ $ dp $ é¢˜ï¼Œå› ä¸ºæ ‡ç­¾å·²ç»å‘Šè¯‰æˆ‘ä»¬äº†ï¼ˆä¸æ˜¯</p><p>æ€ä¹ˆ $ dp $ å‘¢ï¼Ÿ</p><p>æ£‹ç›˜ï¼Ÿä¸‰ç»´å¿…ç‚¸å•Šï¼Œ<del>äºŒç»´æœ¬è’Ÿè’»ä¸ä¼š</del></p><p>æ—¶é—´ï¼Ÿ<del>æ›´ç¦»è°±äº†</del></p><p>æ‰€ä»¥å°±åªèƒ½ä»é¼¹é¼ ä¸‹æ‰‹äº†</p><p>è®¾ $ dp_i $ ä¸ºåˆ°ç¬¬ $ i $ åªé¼¹é¼ æ—¶æœ€å¤šèƒ½æ‰“åˆ°å‡ åª</p><p>å› ä¸ºæˆ‘ä»¬è¦å®ˆæ ªå¾…å…”ï¼ˆé¼ ï¼‰ï¼Œæ‰€ä»¥åˆå§‹åŒ– $ dp_i=1 $ </p><p>è‹¥ä¸¤é¼¹é¼ ä¹‹é—´çš„<a href="https://baike.baidu.com/item/æ›¼å“ˆé¡¿è·ç¦»/743092?fr=aladdin">æ›¼å“ˆé¡¿è·ç¦»</a>å°äºå‡ºç°æ—¶é—´å·®</p><p>æ­¤æ—¶è½¬ç§»æ–¹ç¨‹ä¸º $ dp_i=min(dp[i],dp[j]+1) $ </p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;cstdio&gt;#include&lt;cmath&gt;#define fo(i,x,y) for(register int i&#x3D;x;i&lt;&#x3D;y;++i)#define go(i,x,y) for(register int i&#x3D;x;i&gt;&#x3D;y;--i)#define INF 0x3f3f3f3f#define il inline#define ll long long#define ull unsigned long longusing namespace std;const int N &#x3D; 1005, M &#x3D; 10005;int n, m, dp[M], ans;struct NODE &#123;int time, x, y;&#125;node[M];il int max(const int &amp;a, const int &amp;b) &#123;return a &gt; b ? a : b;&#125;int main() &#123;scanf(&quot;%d%d&quot;, &amp;n, &amp;m);fo(i, 1, m) scanf(&quot;%d%d%d&quot;, &amp;node[i].time, &amp;node[i].x, &amp;node[i].y), dp[i] &#x3D; 1;fo(i, 1, m) &#123;fo(j, 1, i - 1) &#123;if(abs(node[i].x - node[j].x) + abs(node[i].y - node[j].y) &lt;&#x3D; abs(node[i].time - node[j].time)) &#123;dp[i] &#x3D; max(dp[i], dp[j] + 1);&#125;&#125;&#125;fo(i, 1, m) ans &#x3D; max(ans, dp[i]);printf(&quot;%d\n&quot;, ans);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é¢˜ç›®é“¾æ¥&quot;&gt;&lt;a href=&quot;#é¢˜ç›®é“¾æ¥&quot; class=&quot;headerlink&quot; title=&quot;é¢˜ç›®é“¾æ¥&quot;&gt;&lt;/a&gt;é¢˜ç›®é“¾æ¥&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.luogu.com.cn/problem/P2285&quot;&gt;P2285 æ‰“é¼¹é¼ &lt;/a&gt;</summary>
      
    
    
    
    <category term="é¢˜è§£" scheme="http://www.honahec.com/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
    <category term="C++" scheme="http://www.honahec.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Radio Contact G</title>
    <link href="http://www.honahec.com/radio-contact-g/"/>
    <id>http://www.honahec.com/radio-contact-g/</id>
    <published>2021-06-25T13:50:26.000Z</published>
    <updated>2021-09-17T12:45:11.484Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://www.luogu.com.cn/problem/P3133">P3133 Radio Contact G</a></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p> $ dp $ é¢˜</p><p>è®¾ $ dp_{i,j} $ ä¸ºFarmer Johnèµ°åˆ°ç¬¬iæ­¥ï¼ŒBessieèµ°åˆ°ç¬¬jæ­¥éœ€è¦çš„æœ€å°èƒ½é‡</p><p>å¾ˆå®¹æ˜“å¾—åˆ°è½¬ç§»æ–¹ç¨‹ $ f_{i,j}=min(f_{i-1,j},f_{i,j-1},f_{i-1,j-1})+dist $ </p><p>å…¶ä¸­ $ dist $ ä¸ºFarmer Johnåœ¨ç¬¬iæ­¥ï¼ŒBessieåœ¨ç¬¬jæ­¥æ—¶ä»–ä»¬<a href="https://baike.baidu.com/item/æ¬§å‡ é‡Œå¾—åº¦é‡/1274107?fromtitle=æ¬§å‡ é‡Œå¾—è·ç¦»&amp;fromid=2701459">æ¬§å‡ é‡Œå¾—è·ç¦»</a>çš„å¹³æ–¹</p><p>å³ $ (x_1-x_2)^2-(y_1-y_2)^2 $ </p><h3 id="æ³¨æ„ä¸€ä¸‹åˆå§‹åŒ–ï¼š"><a href="#æ³¨æ„ä¸€ä¸‹åˆå§‹åŒ–ï¼š" class="headerlink" title="æ³¨æ„ä¸€ä¸‹åˆå§‹åŒ–ï¼š"></a>æ³¨æ„ä¸€ä¸‹åˆå§‹åŒ–ï¼š</h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">f[i][0] &#x3D; f[i - 1][0] + dist;f[0][i] &#x3D; f[i - 1][0] + dist;f[0][0] &#x3D; 0; &#x2F;&#x2F;åˆå§‹ä½ç½®ä¸æ¶ˆè€—èƒ½é‡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç„¶åè¿™é“é¢˜å°±æ„‰å¿«çš„ACäº†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;cstdio&gt;#include&lt;cstring&gt;#define fo(i,x,y) for(register int i&#x3D;x;i&lt;&#x3D;y;++i)#define go(i,x,y) for(register int i&#x3D;x;i&gt;&#x3D;y;--i)#define INF 0x3f3f3f3f#define il inline#define ll long long#define ull unsigned long longusing namespace std;const int N &#x3D; 1005;int n, m, fx, fy, bx, by;char fs[N], bs[N];int f[N][N];il int min(const int &amp;a, const int &amp;b) &#123;return a &lt; b ? a : b;&#125;il void move(int &amp;x, int &amp;y, const char &amp;t) &#123;switch(t) &#123;case &#39;N&#39;: ++y; break;case &#39;S&#39;: --y; break;case &#39;E&#39;: ++x; break;case &#39;W&#39;: --x; break;&#125;&#125;il int dist(const int &amp;x1, const int &amp;y1, const int &amp;x2, const int &amp;y2) &#123;return (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);&#125;int main() &#123;scanf(&quot;%d%d%d%d%d%d%s%s&quot;, &amp;n, &amp;m, &amp;fx, &amp;fy, &amp;bx, &amp;by, fs + 1, bs + 1);int lenf &#x3D; strlen(fs + 1), lenb &#x3D; strlen(bs + 1);int tx1 &#x3D; fx, ty1 &#x3D; fy, tx2 &#x3D; bx, ty2 &#x3D; by;fo(i, 1, lenf) &#123;move(tx1, ty1, fs[i]);f[i][0] &#x3D; f[i - 1][0] + dist(tx1, ty1, bx, by);&#125;fo(i, 1, lenb) &#123;move(tx2, ty2, bs[i]);f[0][i] &#x3D; f[0][i - 1] + dist(fx, fy, tx2, ty2);&#125;&#x2F;&#x2F;åˆå§‹åŒ–tx1 &#x3D; fx, ty1 &#x3D; fy;fo(i, 1, lenf) &#123;tx2 &#x3D; bx, ty2 &#x3D; by;move(tx1, ty1, fs[i]);fo(j, 1, lenb) &#123;move(tx2, ty2, bs[j]);f[i][j] &#x3D; min(f[i - 1][j], min(f[i][j - 1], f[i - 1][j - 1])) + dist(tx1, ty1, tx2, ty2);&#125;&#125;printf(&quot;%lld\n&quot;, f[lenf][lenb]);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é¢˜ç›®é“¾æ¥&quot;&gt;&lt;a href=&quot;#é¢˜ç›®é“¾æ¥&quot; class=&quot;headerlink&quot; title=&quot;é¢˜ç›®é“¾æ¥&quot;&gt;&lt;/a&gt;é¢˜ç›®é“¾æ¥&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.luogu.com.cn/problem/P3133&quot;&gt;P3133 Radio C</summary>
      
    
    
    
    <category term="é¢˜è§£" scheme="http://www.honahec.com/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
    <category term="C++" scheme="http://www.honahec.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰ç†æ•°å–ä½™</title>
    <link href="http://www.honahec.com/you-li-shu-qu-yu/"/>
    <id>http://www.honahec.com/you-li-shu-qu-yu/</id>
    <published>2021-06-25T13:49:03.000Z</published>
    <updated>2021-09-17T12:45:11.492Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p><a href="https://www.luogu.com.cn/problem/P2613">P2613 ã€æ¨¡æ¿ã€‘æœ‰ç†æ•°å–ä½™</a></p><h3 id="é¢˜ç›®éå¸¸ç®€å•æ˜“æ‡‚"><a href="#é¢˜ç›®éå¸¸ç®€å•æ˜“æ‡‚" class="headerlink" title="é¢˜ç›®éå¸¸ç®€å•æ˜“æ‡‚"></a>é¢˜ç›®éå¸¸ç®€å•æ˜“æ‡‚</h3><p>ç»™å‡ºä¸€ä¸ªæœ‰ç†æ•° $ c=\frac{a}{b} $ï¼Œæ±‚ $ c\bmod19260817 $  çš„å€¼ã€‚</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>çœ‹åˆ°è¿™é“é¢˜æ—¶</p><ul><li>ç¬¬ä¸€çœ¼ï¼šå¥½åƒå¾ˆç®€å•å•Š</li><li>ç¬¬äºŒçœ¼ï¼š$ a,b\leq10^{10001} $ï¼Ÿï¼ï¼</li><li>ç¬¬ä¸‰çœ¼ï¼šå§æ§½è¿™å•¥ç©æ„ï¼Ÿï¼ï¼</li></ul><p>è¦åšè¿™é“é¢˜ï¼Œæˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸ªæ–°çš„ä¸œè¥¿<del>ï¼ˆä¸»è¦æ˜¯æœ¬è’Ÿè’»ä¸ä¼š<code>exgcd</code>ï¼ˆæ¬§å‡ é‡Œå¾—æ‰©å±•ï¼‰</del></p><h3 id="é€†å…ƒ"><a href="#é€†å…ƒ" class="headerlink" title="é€†å…ƒ"></a>é€†å…ƒ</h3><blockquote><p>P æ˜¯ä¸€ä¸ªè´¨æ•°</p></blockquote><p>ä»¤ $ bâ€™ $ ä¸º $ b $ çš„é€†å…ƒï¼Œé‚£ä¹ˆæœ‰$ b\times bâ€™\equiv1\,(mod\,P) $</p><p>æœ‰ $ \frac{a}{b}\equiv\frac{a}{b}\times1\equiv\frac{a}{b}\times(b\times bâ€™)\equiv a\times bâ€™\,(mod\,P) $ </p><p>æ˜¾ç„¶å¯ä»¥çœ‹å‡º $ bâ€™ $ çš„å€¼ä¸º $ \frac{1}{b} $ </p><p>ä½†æ˜¯é™¤ä»¥ $ b $ ä¸ä¹˜ä»¥ $ \frac{1}{b} $ æ˜¯ä¸€æ ·çš„å•Šï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><h3 id="è´¹é©¬å°å®šç†é—ªäº®ç™»åœº"><a href="#è´¹é©¬å°å®šç†é—ªäº®ç™»åœº" class="headerlink" title="è´¹é©¬å°å®šç†é—ªäº®ç™»åœº"></a>è´¹é©¬å°å®šç†é—ªäº®ç™»åœº</h3><p><strong>å®šç†å†…å®¹ï¼šå¦‚æœ $ p$  æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œè€Œæ•´æ•° $ a$  ä¸æ˜¯ $ p$  çš„å€æ•°ï¼Œåˆ™æœ‰$ a^{p-1}\equiv1\,(mod\,p) $</strong></p><h4 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p><strong>ä½ å¯ä»¥é€‰æ‹©<a href="#toc-heading-7">è·³è¿‡</a>è¿™éƒ¨åˆ†</strong></p><blockquote><p> è¯æ˜éƒ¨åˆ† $ p $ æ˜¯ä¸€ä¸ªè´¨æ•°</p></blockquote><h5 id="ç¬¬ä¸€ä¸ªè¯æ˜"><a href="#ç¬¬ä¸€ä¸ªè¯æ˜" class="headerlink" title="ç¬¬ä¸€ä¸ªè¯æ˜"></a>ç¬¬ä¸€ä¸ªè¯æ˜</h5><p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå‰ç½®å®šç†ï¼š</p><p>è‹¥$ gcd(c,p)=1 $ï¼Œä¸”$ ac\equiv bc\,(mod\,p) $ï¼Œé‚£ä¹ˆæœ‰$ a\equiv b\,(mod\,p) $</p><p><strong>è¯ï¼š</strong></p><script type="math/tex; mode=display">\begin{align}&\because ac\equiv bc\,(mod\,p)\\&\therefore (a-b)c\equiv 0\,(mod\,p)\\&\therefore (a-b)c\,æ˜¯\,p\,çš„æ•´æ•°å€\\åˆ&\because gcd(c,p)=1\\&\therefore a-b\equiv0\,(mod\,p)\\&å³a\equiv b\,(mod\,p)\end{align}</script><p><strong>è¯æ¯•</strong></p><h5 id="ç¬¬äºŒä¸ªè¯æ˜"><a href="#ç¬¬äºŒä¸ªè¯æ˜" class="headerlink" title="ç¬¬äºŒä¸ªè¯æ˜"></a>ç¬¬äºŒä¸ªè¯æ˜</h5><p>ç„¶åæˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼Œå‡è®¾æœ‰æ­£æ•´æ•°$ a(a&lt;p) $ æ»¡è¶³æ¡ä»¶$ gcd(a,p)=1 $ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°† $ a $ ä¹˜ä¸Š $ 1\thicksim p-1 $ åå¯ä»¥æ„æˆä¸€ä¸ª $ mod\,p $ çš„<a href="https://baike.baidu.com/item/%E5%AE%8C%E5%85%A8%E5%89%A9%E4%BD%99%E7%B3%BB">å®Œå…¨å‰©ä½™ç³»</a></p><p><strong>è¯ï¼š</strong></p><script type="math/tex; mode=display">\begin{align}&å‡è®¾å­˜åœ¨xa\equiv ya\,(mod\,p),ä¸”x\neq y\\&\because gcd(a,p)=1\\&\therefore åŸå¼æˆç«‹å½“ä¸”ä»…å½“x\equiv y\,(mod\,p)\\åˆ&\because x,y\in [1,p-1]\\&\therefore x\equiv y\,(mod\,p)å½“ä¸”ä»…å½“x=y,ä¸å·²çŸ¥æ¡ä»¶çŸ›ç›¾\\&\therefore å‡è®¾ä¸æˆç«‹ï¼ŒåŸå‘½é¢˜æˆç«‹\end{align}</script><p><strong>è¯æ¯•</strong></p><h5 id="ç¬¬ä¸‰ä¸ªè¯æ˜"><a href="#ç¬¬ä¸‰ä¸ªè¯æ˜" class="headerlink" title="ç¬¬ä¸‰ä¸ªè¯æ˜"></a>ç¬¬ä¸‰ä¸ªè¯æ˜</h5><p>æ¥ä¸‹æ¥è¯æ˜ $ a^{p-1}\equiv1\,(mod\,p) $ </p><p><strong>è¯ï¼š</strong></p><script type="math/tex; mode=display">\begin{align}&\because 1,2,\cdots,p-1æ˜¯\,mod\,p\,çš„å®Œå…¨å‰©ä½™ç³»\\&\thereforeæœ‰1\times2\times\cdots\times p-1\equiv a\times2a\times\cdots\times (p-1)a\,(mod\,p)\\&å³ (p-1)!\equiv (p-1)!\times a^{p-1}\,(mod\,p)\\åˆ&\because pæ˜¯è´¨æ•°\\&\therefore gcd((p-1)!,p)=1\\&\therefore a^{p-1}\equiv1\,(mod\,p)\end{align}</script><p><strong>è¯æ¯•</strong></p><h4 id="å›å½’æ­£é¢˜"><a href="#å›å½’æ­£é¢˜" class="headerlink" title="å›å½’æ­£é¢˜"></a>å›å½’æ­£é¢˜</h4><p>æ ¹æ®è´¹é©¬å°å®šç†ï¼Œæ˜¾ç„¶ $ bâ€™=b^{P-2} $ </p><p>ä»€ä¹ˆï¼Ÿä¸æ˜¾ç„¶å—ï¼Ÿ</p><script type="math/tex; mode=display">\begin{align}\because b'\times b&\equiv1\,(mod\,P)\\b^{P-1}&\equiv1\,(mod\,P)\\\therefore b'\times b&\equiv b^{P-1}\,(mod\,P)\\\therefore b'&=b^{P-2}\end{align}</script><p>é‚£ä¹ˆ $ \frac{a}{b}=a\times b^{P-2} $ </p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç”¨å¿«é€Ÿå¹‚è½»æ¾Aæ‰è¿™é¢˜äº†ï¼ˆ$ ps$ ï¼šè™½ç„¶å¿«é€Ÿå¹‚è®©æˆ‘ä»¬ä¸éœ€è¦é«˜ç²¾äº†ï¼Œä½†<code>long long</code>è¿˜æ˜¯è¦çš„</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;cstdio&gt;const int MOD &#x3D; 19260817;inline long long read() &#123;long long X &#x3D; 0, flag &#x3D; 1; char ch &#x3D; getchar();while(ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;if(ch &#x3D;&#x3D; &#39;-&#39;) flag &#x3D; 0; ch&#x3D;getchar();&#125;while(ch &gt;&#x3D; &#39;0&#39; &amp;&amp; ch &lt;&#x3D; &#39;9&#39;) &#123;X &#x3D; (X * 10 + (ch ^ 48)) % MOD; ch &#x3D; getchar();&#125;return flag ? X : -X;&#125;long long a, b;long long QuickPow(long long x, long long y) &#123;long long ans &#x3D; 1, k &#x3D; MOD - 2;while(k) &#123;if(k &amp; 1) ans &#x3D; ans * x % MOD;x &#x3D; x * x % MOD;k &gt;&gt;&#x3D; 1;&#125;return ans * y % MOD;&#125;&#x2F;&#x2F;å¿«é€Ÿå¹‚ä¸å»ºè®®è¿™æ ·å†™ï¼Œè¿˜æ˜¯ç”¨æ¨¡æ¿æ¯”è¾ƒå¥½int main() &#123;a &#x3D; read(); b &#x3D; read();if(b) printf(&quot;%lld\n&quot;, QuickPow(b, a));else printf(&quot;Angry!\n&quot;);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é¢˜ç›®æè¿°&quot;&gt;&lt;a href=&quot;#é¢˜ç›®æè¿°&quot; class=&quot;headerlink&quot; title=&quot;é¢˜ç›®æè¿°&quot;&gt;&lt;/a&gt;é¢˜ç›®æè¿°&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.luogu.com.cn/problem/P2613&quot;&gt;P2613 ã€æ¨¡æ¿ã€‘æœ‰ç†æ•°</summary>
      
    
    
    
    <category term="é¢˜è§£" scheme="http://www.honahec.com/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
    <category term="C++" scheme="http://www.honahec.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://www.honahec.com/hello-world/"/>
    <id>http://www.honahec.com/hello-world/</id>
    <published>2021-06-25T13:38:19.000Z</published>
    <updated>2021-09-19T07:20:34.480Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Hello-å¤§å®¶å¥½å•Š"><a href="#Hello-å¤§å®¶å¥½å•Š" class="headerlink" title="Hello å¤§å®¶å¥½å•Š"></a>Hello å¤§å®¶å¥½å•Š</h2><p>æˆ‘æ˜¯Honahecï¼Œä¸€ä¸ªè’Ÿè’»</p><p>ç›®å‰è¿™ä¸ªåšå®¢ä»åœ¨å»ºè®¾ä¸­ï¼Œå¦‚æœæ‚¨æœ‰ä»»ä½•æƒ³æ³•éƒ½å¯ä»¥åœ¨<strong>ä¸Šæ–¹çš„ç•™è¨€æ¿</strong>ä¸­ç•™è¨€æˆ–è€…æ·»åŠ æˆ‘çš„QQï¼Œæˆ‘ä¼šåŠæ—¶å›å¤å¹¶é‡‡çº³éƒ¨åˆ†å»ºè®®</p><p>å¦‚æœæ‚¨ä¹Ÿæƒ³è¦å»ºè®¾ä¸€ä¸ªå±äºè‡ªå·±çš„åšå®¢ä¹Ÿå¯ä»¥è”ç³»æˆ‘</p><p><strong>è°¢è°¢å¤§å®¶</strong></p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include&lt;cstdio&gt;int main() &#123;    printf(&quot;Hello World!\n&quot;);    return 114514; &#x2F;&#x2F;:)&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Hello-å¤§å®¶å¥½å•Š&quot;&gt;&lt;a href=&quot;#Hello-å¤§å®¶å¥½å•Š&quot; class=&quot;headerlink&quot; title=&quot;Hello å¤§å®¶å¥½å•Š&quot;&gt;&lt;/a&gt;Hello å¤§å®¶å¥½å•Š&lt;/h2&gt;&lt;p&gt;æˆ‘æ˜¯Honahecï¼Œä¸€ä¸ªè’Ÿè’»&lt;/p&gt;
&lt;p&gt;ç›®å‰è¿™ä¸ªåšå®¢ä»åœ¨å»ºè®¾ä¸­ï¼Œå¦‚æœæ‚¨æœ‰</summary>
      
    
    
    
    <category term="éšä¾¿è¯´è¯´" scheme="http://www.honahec.com/categories/%E9%9A%8F%E4%BE%BF%E8%AF%B4%E8%AF%B4/"/>
    
    
    <category term="æ‘¸é±¼" scheme="http://www.honahec.com/tags/%E6%91%B8%E9%B1%BC/"/>
    
  </entry>
  
</feed>
